# GC-QQQ Method Generator - 测试指南

## 快速测试流程

### 前提条件
开发服务器已启动：
```bash
npm run dev
```
访问：`http://localhost:3000`

---

## 测试场景 1：标准工作流（推荐路径）

### 步骤 1：输入化合物

**操作：**
1. 在首页文本框中粘贴以下示例：
```
1912-24-9
Chlorpyrifos
Malathion
Fenitrothion
Parathion
56-38-2
```

2. 点击"处理输入并下一步"

**预期结果：**
- ✅ 显示"命中 X"和"未匹配 Y"统计
- ✅ 自动跳转到步骤 2

---

### 步骤 2：选择 GC 方法

**操作：**
1. 选择"含 GC 方法（推荐）"
2. 选择"A-30m-CF"方法卡片
3. 点击"下一步"

**预期结果：**
- ✅ 方法卡片高亮显示（蓝色边框 + 阴影）
- ✅ 构建方法成功，跳转到步骤 3

---

### 步骤 3：RI 标定

**操作 A - 使用模板：**
1. 点击"模板下载"按钮
2. 打开下载的 `alkane_calibration_template.csv`
3. 复制内容粘贴到"手动输入 RI 标定数据"文本框
4. 点击"应用标定"

**操作 B - 手动输入（最小测试）：**
在文本框中输入至少 5 个烷烃：
```
C8,  2.466
C9,  3.014
C10, 3.513
C11, 3.970
C12, 4.400
```
点击"应用标定"

**预期结果：**
- ✅ 显示 Alert："RI 标定成功！已更新 X 个化合物的 RT 预测值。"
- ✅ 结果表的"RT_pred"列显示数值（如 2.5、3.2 等）
- ✅ 标定卡片变为绿色"标定已应用"状态

---

### 步骤 4：导出结果

**操作：**
1. 滚动到页面底部
2. 点击"导出全部"按钮

**预期结果：**
- ✅ 自动下载 `method_generic.csv`
- ✅ 自动下载 `method_masshunter.csv`
- ✅ 如有未匹配化合物，下载 `gap_report.csv`

---

## 测试场景 2：边界情况测试

### 2.1 烷烃数量不足

**输入：**
```
C8, 2.5
C9, 3.0
C10, 3.5
```
（只有 3 个烷烃）

**点击："应用标定"**

**预期结果：**
```
只成功解析了 3 个烷烃，至少需要 5 个。

解析错误：
（无错误，只是数量不够）
```

**状态：** ✅ 应显示错误弹窗

---

### 2.2 大小写混合

**输入：**
```
c8,  2.466
C9,  3.014
c10, 3.513
C11, 3.970
c12, 4.400
```

**点击："应用标定"**

**预期结果：**
- ✅ 成功解析（自动转为大写）
- ✅ 控制台显示：`成功解析: 5`

---

### 2.3 欧式小数格式

**输入：**
```
C8,  2,466
C9,  3,014
C10, 3,513
C11, 3,970
C12, 4,400
```
（注意：使用逗号作为小数点）

**点击："应用标定"**

**预期结果：**
- ✅ 成功解析（逗号转为句点）
- ✅ 数值正确：2.466, 3.014, 3.513...

---

### 2.4 包含注释和空行

**输入：**
```
# 这是注释，应该被忽略
Alkane, RT(min)

C8,  2.466
C9,  3.014

# 另一个注释
C10, 3.513
C11, 3.970
C12, 4.400
```

**点击："应用标定"**

**预期结果：**
- ✅ 成功解析 5 个烷烃
- ✅ 跳过注释行、表头行和空行

---

### 2.5 无效 RT 值

**输入：**
```
C8,  abc
C9,  3.014
C10, xyz
C11, 3.970
C12, 4.400
C13, 4.810
C14, 5.210
```

**点击："应用标定"**

**预期结果：**
```
只成功解析了 5 个烷烃，至少需要 5 个。

解析错误：
第 1 行: RT 值无效 "abc"
第 3 行: RT 值无效 "xyz"
```
（注意：成功解析了 5 个有效烷烃，应该能通过）

**实际行为：** 如果只有 5 个有效 + 2 个无效，应该能成功标定。

---

### 2.6 分隔符多样性

**输入：**
```
C8,  2.466
C9	3.014
C10 3.513
C11  ,  3.970
C12    4.400
```
（使用逗号、制表符、空格混合分隔）

**点击："应用标定"**

**预期结果：**
- ✅ 成功解析所有 5 个烷烃
- ✅ 分隔符类型无影响

---

## 测试场景 3：错误恢复

### 3.1 标定失败后重试

**步骤：**
1. 输入少于 5 个烷烃 → 失败
2. 点击"清除"按钮
3. 重新输入 5+ 个烷烃 → 成功

**预期结果：**
- ✅ 第一次失败后不影响后续操作
- ✅ 清除按钮正常工作
- ✅ 第二次尝试成功

---

### 3.2 返回上一步后状态保持

**步骤：**
1. 完成步骤 1-2，进入步骤 3
2. 点击底部"上一步"按钮
3. 返回步骤 2
4. 再次点击"下一步"

**预期结果：**
- ✅ 已输入的化合物保留
- ✅ 已构建的结果表保留
- ✅ 不需要重新输入数据

---

## 测试场景 4：UI/UX 验证

### 4.1 EPA 风格主题

**检查项：**
- [ ] 页头背景色为深蓝（#005EA2）
- [ ] 活动按钮/链接为蓝色
- [ ] 字体大小合适（18px 基础）
- [ ] 标题层级清晰（H1 > H2 > H3）

---

### 4.2 双栏布局

**检查项：**
- [ ] 左侧边栏固定，包含"Categories"
- [ ] 右侧主内容区可滚动
- [ ] 工作流图在主内容区顶部
- [ ] 响应式：小屏幕时侧栏折叠

---

### 4.3 工作流步骤指示器

**检查项：**
- [ ] 当前步骤高亮（深蓝色 + 光环）
- [ ] 已完成步骤显示绿色勾选
- [ ] 未开始步骤显示灰色
- [ ] 已完成步骤可点击返回

---

## 快速测试检查清单

### ✅ 核心功能（5 分钟）
- [ ] 输入化合物 → 归一化成功
- [ ] 选择 GC 方法 → 构建成功
- [ ] 应用 RI 标定（5+ 烷烃）→ RT_pred 更新
- [ ] 导出 CSV → 文件下载成功

### ✅ 边界情况（5 分钟）
- [ ] 少于 5 个烷烃 → 错误提示清晰
- [ ] 大小写混合 → 自动转换
- [ ] 欧式小数 → 正确解析
- [ ] 注释和空行 → 自动跳过

### ✅ UI/UX（2 分钟）
- [ ] EPA 深蓝主题应用
- [ ] 双栏布局正常
- [ ] 按钮和链接可点击
- [ ] 加载态显示正确

---

## 常见问题排查

### 问题 1：页面空白

**解决方案：**
1. 检查开发服务器是否运行：`ps aux | grep next`
2. 重启服务器：`npm run dev`
3. 清除浏览器缓存并刷新（Cmd+Shift+R / Ctrl+Shift+R）

---

### 问题 2：RI 标定失败（明明输入了 5+ 个烷烃）

**检查：**
1. 打开浏览器控制台（F12）
2. 查看"解析统计"输出：
   ```
   解析统计: {
     总行数: X,
     成功解析: Y,
     失败: Z,
     解析错误: [...]
   }
   ```
3. 根据"解析错误"列表修正输入格式

**常见原因：**
- RT 值包含非数字字符（如单位"min"）
- 使用了不支持的分隔符（如分号`;`）
- 缺少 RT 值（只有烷烃名称）

---

### 问题 3：导出的 CSV 文件为空

**检查：**
1. 确认结果表中有数据
2. 确认至少完成了"步骤 2：构建方法"
3. 检查浏览器下载设置（是否拦截下载）

---

### 问题 4：RT_pred 列没有数值

**原因：**
未应用 RI 标定，或标定失败。

**解决方案：**
1. 在步骤 3 的"RI 标定"卡片中输入烷烃数据
2. 确保至少 5 个有效烷烃
3. 点击"应用标定"
4. 等待 Alert："RI 标定成功！"

---

## 性能测试（可选）

### 大数据量测试

**输入化合物：**
- 10 个化合物 → 应 < 1 秒
- 50 个化合物 → 应 < 3 秒
- 100 个化合物 → 应 < 10 秒

**烷烃数据：**
- 5 个烷烃 → 应 < 0.5 秒
- 20 个烷烃（C8-C27）→ 应 < 1 秒
- 28 个烷烃（C8-C35）→ 应 < 2 秒

---

## 测试报告模板

```markdown
# 测试报告

**测试日期：** YYYY-MM-DD  
**测试人员：** [姓名]  
**浏览器：** Chrome / Firefox / Safari / Edge  
**版本：** [浏览器版本]

## 测试结果

### 场景 1：标准工作流
- [ ] 通过
- [ ] 失败：[描述问题]

### 场景 2：边界情况
- [ ] 2.1 烷烃数量不足 - 通过/失败
- [ ] 2.2 大小写混合 - 通过/失败
- [ ] 2.3 欧式小数 - 通过/失败
- [ ] 2.4 注释和空行 - 通过/失败
- [ ] 2.5 无效 RT 值 - 通过/失败
- [ ] 2.6 分隔符多样性 - 通过/失败

### 场景 3：错误恢复
- [ ] 3.1 标定失败后重试 - 通过/失败
- [ ] 3.2 返回上一步 - 通过/失败

### 场景 4：UI/UX
- [ ] EPA 主题 - 通过/失败
- [ ] 双栏布局 - 通过/失败
- [ ] 步骤指示器 - 通过/失败

## 发现的问题

1. [问题描述]
   - 严重程度：高/中/低
   - 重现步骤：
   - 截图：

## 建议

[测试人员的改进建议]
```

---

**文档版本：** v1.0  
**最后更新：** 2025年11月2日

